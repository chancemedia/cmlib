<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMLIB: 6.1. Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="manual.html">Manual</a>&nbsp;&raquo;&nbsp;<a class="el" href="manual__dm.html">6. Data Model</a>
  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="manual_dm_intro_contents">
Contents</a></h2>
<ol type="1">
<li><a class="el" href="manual__dm__intro.html#manual_dm_intro_desc">Description</a></li>
<li><a class="el" href="manual__dm__intro.html#manual_dm_intro_whatdoesitdo">What Does It Do?</a></li>
<li><a class="el" href="manual__dm__intro.html#manual_dm_intro_example1">Example: A Guest Book</a></li>
</ol>
<h2><a class="anchor" id="manual_dm_intro_desc">
Description</a></h2>
<p>The data model provides a way to use data between the backend server, the database and the front end HTML objects in a way that is non-ambiguous, safe and easy.</p>
<h2><a class="anchor" id="manual_dm_intro_whatdoesitdo">
What Does It Do?</a></h2>
<ul>
<li>A session (that is, a discreet bond between a given user and the server) can have multiple CMDataModels, each of which remain completely separate from each other.</li>
<li>In each <a class="el" href="class_c_m_data_model.html" title="Data model provides above-session data modeling.">CMDataModel</a> has a set of data pools where each data pool may contain fields specific to a view, database table, screen or other groupable entity. This not only eliminates the ambiguity of duplicate field names or database tables with the same column names, but also creates a discreet pool of only-relevant content to send to a database or external script.</li>
<li>Each <a class="el" href="class_c_m_data_model.html" title="Data model provides above-session data modeling.">CMDataModel</a> has a 'get' and 'post' pool that are automatically maintained with the $_GET and $_POST submissions.</li>
<li><a class="el" href="class_c_m_data_model.html" title="Data model provides above-session data modeling.">CMDataModel</a> can retain large amounts of text and binary information that does not have to be passed through the browser, but also accessed at any time.</li>
<li>A global storage pool that allows information to be safely shared between CMDataModels without crossing the boundaries of a user.</li>
<li><a class="el" href="class_c_m_data_model.html" title="Data model provides above-session data modeling.">CMDataModel</a> automatically tracks URL history to allow submitting backwards one or more steps.</li>
<li>No JavaScript to implement any features. All code, including forward and backward form submission is done server side so it's not browser inderpendant.</li>
<li>Higher security. Information in a <a class="el" href="class_c_m_data_model.html" title="Data model provides above-session data modeling.">CMDataModel</a> can not be altered by simply changing posted values in the HTML. On top of that, pools can be locked so no outside entity can change their values, this is ideal for storing passwords and other authentication.</li>
</ul>
<p>Native (built-in) support for:</p>
<ul>
<li><a class="el" href="interface_c_m_database_protocol.html" title="All database connectivity classes implement this interface.">CMDatabaseProtocol</a> to be able to interact with any database engine (such as MySQL, PostgreSQL or Oracle) without the need to change any code.</li>
<li><a class="el" href="class_c_m_data_model_validator.html" title="Validator for CMDataModel.">CMDataModelValidator</a> to validate posted or sent information with a variety of automatic and pattern matching options. Human-readable messages are generated.</li>
<li><a class="el" href="class_c_m_form.html" title="HTML form object builder.">CMForm</a> to build HTML form objects from a pool. This eliminates the need to manually program in the returning of fields to a page.</li>
<li>Serialisation allows an instant consistent snapshot of an entire <a class="el" href="class_c_m_data_model.html" title="Data model provides above-session data modeling.">CMDataModel</a> to save in a a database or file.</li>
</ul>
<h2><a class="anchor" id="manual_dm_intro_example1">
Example: A Guest Book</a></h2>
<div class="fragment"><pre class="fragment"> &lt;?php
 include_once(<span class="stringliteral">&quot;cmlib/lib/CMDataModel.php&quot;</span>);
 
 <span class="comment">// get the default data model</span>
 $dm = <a class="code" href="class_c_m_data_model.html#a8dd8e36efd073d98f8b297df8958053a" title="Get a data model by name.">CMDataModel::GetDataModel</a>();
 
 <span class="comment">// attach a database if this hasn&#39;t already been done, lets use MySQL</span>
 <span class="keywordflow">if</span>(!$dm-&gt;hasDatabase())
   $dm-&gt;setDatabase(<span class="keyword">new</span> <a class="code" href="class_c_m_my_s_q_l.html" title="MySQL connectivity class.">CMMySQL</a>(<span class="stringliteral">&quot;mysql://root:abcd1234@localhost/test&quot;</span>));
 
 <span class="comment">// if the form was submitted</span>
 <span class="keywordflow">if</span>($dm-&gt;request(<span class="stringliteral">&#39;submit&#39;</span>)) {
   <span class="comment">// validate the submitted page</span>
   <span class="comment">// the &#39;+&#39; means the field is mandatory, the &#39;@&#39; means it must be a valid email address</span>
   $dm-&gt;setValidator(<span class="keyword">new</span> <a class="code" href="class_c_m_data_model_validator.html" title="Validator for CMDataModel.">CMDataModelValidator</a>(<span class="stringliteral">&#39;+person[firstname] +person[lastname] +@person[email]&#39;</span>));
   
   <span class="comment">// if the validate failed, we can submit them back to the previous page, the information</span>
   <span class="comment">// they have already put in will automatically be loaded in</span>
   <span class="keywordflow">if</span>(!$dm-&gt;validate())
     $dm-&gt;submitBackwards();
  
   <span class="comment">// insert record into the database, returning the record ID</span>
   $id = $dm-&gt;databaseInsert(<span class="stringliteral">&#39;person&#39;</span>);
 
   <span class="comment">// optional, but this is so when the person returns they get a new blank form</span>
   $dm-&gt;drainPool(<span class="stringliteral">&#39;person&#39;</span>);
  
   die(<span class="stringliteral">&quot;Thanks for your submission! There is now $id guest records.&quot;</span>);
 }
 
 ?&gt;
 &lt;html&gt;
 &lt;head&gt;&lt;title&gt;<a class="code" href="class_c_m_data_model.html" title="Data model provides above-session data modeling.">CMDataModel</a> demo&lt;/title&gt;&lt;/head&gt;
 
 &lt;body&gt;
 &lt;form method=<span class="stringliteral">&quot;post&quot;</span>&gt;
 
 First name: &lt;?= $dm-&gt;textBox(<span class="stringliteral">&#39;person[firstname]&#39;</span>) ?&gt;
             &lt;?= $dm-&gt;fieldError(<span class="stringliteral">&#39;person[firstname]&#39;</span>) ?&gt;&lt;br/&gt;
             
 Last name:  &lt;?= $dm-&gt;textBox(<span class="stringliteral">&#39;person[lastname]&#39;</span>) ?&gt;
             &lt;?= $dm-&gt;fieldError(<span class="stringliteral">&#39;person[lastname]&#39;</span>) ?&gt;&lt;br/&gt;
             
 Email:      &lt;?= $dm-&gt;textBox(<span class="stringliteral">&#39;person[email]&#39;</span>) ?&gt;
             &lt;?= $dm-&gt;fieldError(<span class="stringliteral">&#39;person[email]&#39;</span>) ?&gt;&lt;br/&gt;
             
 &lt;?= <a class="code" href="class_c_m_form.html#a5541dbf0e2b8b8725ec9a46cbc8feb60" title="Create a submit button.">CMForm::SubmitButton</a>(array(<span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&quot;Next step&quot;</span>)) ?&gt;
 
 &lt;/form&gt;
 &lt;/body&gt;
 &lt;/html&gt;
</pre></div> </div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Apr 1 15:32:23 2010 for CMLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
