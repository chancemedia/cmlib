<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMLIB: 7.1. CSV</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="manual.html">Manual</a>&nbsp;&raquo;&nbsp;<a class="el" href="manual__file.html">7. File Parsing</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="manual_file_csv">7.1. CSV </a></h1><h2><a class="anchor" id="manual_file_csv_contents">
Contents</a></h2>
<ol type="1">
<li><a class="el" href="manual__file__csv.html#manual_file_csv_read">Reading a CSV File</a></li>
<li><a class="el" href="manual__file__csv.html#manual_file_csv_readmap">Reading a CSV with mapped field names.</a></li>
<li><a class="el" href="manual__file__csv.html#manual_file_csv_write">Outputting a CSV file.</a></li>
<li><a class="el" href="manual__file__csv.html#manual_file_csv_rewrite">Rewriting a CSV file.</a></li>
<li><a class="el" href="manual__file__csv.html#manual_file_csv_format">Changing the Input/Output Delimiter and Enclosure</a></li>
<li><a class="el" href="manual__file__csv.html#manual_file_csv_options">Options for CSV Files</a></li>
</ol>
<h2><a class="anchor" id="manual_file_csv_read">
Reading a CSV File</a></h2>
<div class="fragment"><pre class="fragment"> $csv = <span class="keyword">new</span> <a class="code" href="class_c_m_file_c_s_v.html" title="Class for handling CSV (comma-separated values) files.">CMFileCSV</a>();
 <span class="keywordflow">if</span>(!$csv-&gt;readFile(<span class="stringliteral">&#39;csv1.csv&#39;</span>))
   die(<span class="stringliteral">&quot;Unable to read file!&quot;</span>);
 
 <span class="keywordflow">while</span>($line = $csv-&gt;readNext()) {
   print_r($line);
 }
 
 <span class="comment">// Array (</span>
 <span class="comment">//     [0] =&gt; begin_ip</span>
 <span class="comment">//     [1] =&gt; end_ip</span>
 <span class="comment">//     [2] =&gt; begin_num</span>
 <span class="comment">//     [3] =&gt; end_num</span>
 <span class="comment">//     [4] =&gt; country</span>
 <span class="comment">//     [5] =&gt; name</span>
 <span class="comment">// )</span>
 <span class="comment">// Array (</span>
 <span class="comment">//     [0] =&gt; 61.88.0.0</span>
 <span class="comment">//     [1] =&gt; 61.91.255.255</span>
 <span class="comment">//     [2] =&gt; 1029177344</span>
 <span class="comment">//     [3] =&gt; 1029439487</span>
 <span class="comment">//     [4] =&gt; AU</span>
 <span class="comment">//     [5] =&gt; Australia</span>
 <span class="comment">// )</span>
 <span class="comment">// ...</span>
</pre></div><h2><a class="anchor" id="manual_file_csv_readmap">
Reading a CSV with mapped field names.</a></h2>
<div class="fragment"><pre class="fragment"> $fields = array(<span class="stringliteral">&#39;begin_ip&#39;</span>, <span class="stringliteral">&#39;end_ip&#39;</span>, <span class="stringliteral">&#39;begin_num&#39;</span>, <span class="stringliteral">&#39;end_num&#39;</span>, <span class="stringliteral">&#39;country&#39;</span>, <span class="stringliteral">&#39;name&#39;</span>);
 $csv = <span class="keyword">new</span> <a class="code" href="class_c_m_file_c_s_v.html" title="Class for handling CSV (comma-separated values) files.">CMFileCSV</a>($fields);
 <span class="keywordflow">if</span>(!$csv-&gt;readFile(<span class="stringliteral">&#39;csv1.csv&#39;</span>, array(<span class="stringliteral">&#39;skip&#39;</span> =&gt; 1)))
   die(<span class="stringliteral">&quot;Unable to read file!&quot;</span>);
 
 <span class="keywordflow">while</span>($line = $csv-&gt;next()) {
   print_r($line);
 }
 
 <span class="comment">// Array (</span>
 <span class="comment">//     [begin_ip] =&gt; 61.88.0.0</span>
 <span class="comment">//     [end_ip] =&gt; 61.91.255.255</span>
 <span class="comment">//     [begin_num] =&gt; 1029177344</span>
 <span class="comment">//     [end_num] =&gt; 1029439487</span>
 <span class="comment">//     [country] =&gt; AU</span>
 <span class="comment">//     [name] =&gt; Australia</span>
 <span class="comment">// )</span>
 <span class="comment">// ...</span>
</pre></div><h2><a class="anchor" id="manual_file_csv_write">
Outputting a CSV file.</a></h2>
<div class="fragment"><pre class="fragment"> $csv = <span class="keyword">new</span> <a class="code" href="class_c_m_file_c_s_v.html" title="Class for handling CSV (comma-separated values) files.">CMFileCSV</a>();
 <span class="keywordflow">if</span>(!$csv-&gt;prepareWriteFile(<span class="stringliteral">&#39;csv2.csv&#39;</span>))
   die(<span class="stringliteral">&quot;Unable to open file!&quot;</span>);
 
 $data = array(
   array(<span class="stringliteral">&#39;first&#39;</span>, <span class="stringliteral">&#39;last&#39;</span>, <span class="stringliteral">&#39;email&#39;</span>),
   array(<span class="stringliteral">&#39;Bob&#39;</span>, <span class="stringliteral">&#39;Smith&#39;</span>, <span class="stringliteral">&#39;bob@smith.com&#39;</span>),
   array(<span class="stringliteral">&#39;Joe&#39;</span>, <span class="stringliteral">&#39;Bloggs&#39;</span>, <span class="stringliteral">&#39;joe@bloggs.com&#39;</span>)
 );
 
 <span class="keywordflow">foreach</span>($data as $d)
   $csv-&gt;writeNext($d);
 
 <span class="comment">// clean and close the file handle</span>
 $csv-&gt;finishWriteFile();
</pre></div><h2><a class="anchor" id="manual_file_csv_rewrite">
Rewriting a CSV file.</a></h2>
<div class="fragment"><pre class="fragment"> $csvIn = <span class="keyword">new</span> <a class="code" href="class_c_m_file_c_s_v.html" title="Class for handling CSV (comma-separated values) files.">CMFileCSV</a>();
 $csvOut = <span class="keyword">new</span> <a class="code" href="class_c_m_file_c_s_v.html" title="Class for handling CSV (comma-separated values) files.">CMFileCSV</a>();
 <span class="keywordflow">if</span>(!$csvIn-&gt;readFile(<span class="stringliteral">&#39;csv1.csv&#39;</span>) || !$csvOut-&gt;prepareWriteFile(<span class="stringliteral">&#39;csv3.csv&#39;</span>))
   die(<span class="stringliteral">&quot;One of the files could not be opened&quot;</span>);
 
 <span class="comment">// add an ID field at the beginning</span>
 $csvOut-&gt;writeNext(array_merge(array(<span class="stringliteral">&#39;id&#39;</span>), $csvIn-&gt;readNext()));
 <span class="keywordflow">for</span>($i = 1; $line = $csvIn-&gt;readNext(); ++$i) {
   $csvOut-&gt;writeNext(array_merge(array($i), $line));
 }
 
 $csvOut-&gt;finishWriteFile();
 
 <span class="comment">// id,begin_ip,end_ip,begin_num,end_num,country,name</span>
 <span class="comment">// 1,61.88.0.0,61.91.255.255,1029177344,1029439487,AU,Australia</span>
 <span class="comment">// 2,61.92.0.0,61.93.255.255,1029439488,1029570559,HK,&quot;Hong Kong&quot;</span>
 <span class="comment">// 3,61.94.0.0,61.94.7.255,1029570560,1029572607,ID,Indonesia</span>
</pre></div><h2><a class="anchor" id="manual_file_csv_format">
Changing the Input/Output Delimiter and Enclosure</a></h2>
<p>These attributes can be accessed directly within your <a class="el" href="class_c_m_file_c_s_v.html" title="Class for handling CSV (comma-separated values) files.">CMFileCSV</a> instance, the change affect immediatly even if you are in the middle of reading/write a CSV file.</p>
<div class="fragment"><pre class="fragment"> $csv = <span class="keyword">new</span> <a class="code" href="class_c_m_file_c_s_v.html" title="Class for handling CSV (comma-separated values) files.">CMFileCSV</a>();
 $csv-&gt;delimiter = <span class="stringliteral">&quot;\t&quot;</span>; <span class="comment">// change the column delimiter to a tab</span>
 $csv-&gt;enclosure = <span class="stringliteral">&quot;\&quot;&quot;</span>; <span class="comment">// this is the default</span>
</pre></div><h2><a class="anchor" id="manual_file_csv_options">
Options for CSV Files</a></h2>
<table class="doxtable">
<tr>
<th>Name </th><th>Applies to </th><th>Description  </th></tr>
<tr>
<td><code>append</code>  </td><td>Writing CSV </td><td>If a value is given that evaluates to <span style="color: MediumBlue"><code>true</code></span>, then the file handle is placed at the end of the newly opened file handle and any data will be written to the end of the file. Alternativly, if this is not provided it takes a value of <span style="color: MediumBlue"><code>false</code></span> which will cause the file that exists in the location to be replaced. See prepareWriteFile() for more information.  </td></tr>
<tr>
<td><code>skip</code>  </td><td>Reading CSV </td><td>The number of lines to skip when opening the read file handle. A common value is '1' used to skip the field names that appear in some CSV files.  </td></tr>
</table>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
