<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMLIB: 4.4. Decimals</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="manual.html">Manual</a>&nbsp;&raquo;&nbsp;<a class="el" href="manual__fmt.html">4. Data Processing</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="manual_fmt_decimal">4.4. Decimals </a></h1><h2><a class="anchor" id="manual_fmt_decimal_contents">
Contents</a></h2>
<ol type="1">
<li><a class="el" href="manual__fmt__decimal.html#manual_fmt_decimal_intro">Introduction</a></li>
<li><a class="el" href="manual__fmt__decimal.html#manual_fmt_decimal_math">Arithmetic operations</a></li>
<li><a class="el" href="manual__fmt__decimal.html#manual_fmt_decimal_native">Native integration</a></li>
</ol>
<h2><a class="anchor" id="manual_fmt_decimal_intro">
Introduction</a></h2>
<p><a class="el" href="class_c_m_decimal.html" title="Handling exact values.">CMDecimal</a> is designed for dealing with exact numbers - most commonly used with currency calculations. In some cases using normal floating-point numbers is not always the best idea because computers are not always able to give an exact binary representation of even simple floating-point values.</p>
<p>This is certainly not a new problem in computer terms, but still remains important to remember. Take the following example of a modern MySQL installation using a sample table: </p>
<pre>
 create table cmlib_test (
   id int auto_increment primary key,
   name varchar(255),
   num float default 0
 );</pre><pre> mysql&gt; insert into cmlib_test (name, num) values ('John Smith', 3.7);</pre><pre> mysql&gt; select * from cmlib_test;
 +----+------------+------+
 | id | name       | num  |
 +----+------------+------+
 |  1 | John Smith |  3.7 | 
 +----+------------+------+
 1 row in set (0.00 sec)
 </pre><p>But when we try to query the table: </p>
<pre>
 mysql&gt; select * from cmlib_test where num = 3.7;
 Empty set (0.00 sec)</pre><pre> mysql&gt; select * from cmlib_test where num &gt; 3.7;
 +----+------------+------+
 | id | name       | num  |
 +----+------------+------+
 |  1 | John Smith |  3.7 | 
 +----+------------+------+
 1 row in set (0.00 sec)
 </pre><p>If we up the precision you can see the problem: </p>
<pre>
 mysql&gt; select num*1.0 from cmlib_test;
 +------------------+
 | num*1.0          |
 +------------------+
 | 3.70000004768372 | 
 +------------------+
 1 row in set (0.00 sec)
 </pre><p>Use a different type and try again: </p>
<pre>
 mysql&gt; alter table cmlib_test modify column num decimal(18,6);
 Query OK, 1 row affected, 1 warning (0.13 sec)
 Records: 1  Duplicates: 0  Warnings: 1</pre><pre> mysql&gt; select * from cmlib_test where num=3.7;
 +----+------------+----------+
 | id | name       | num      |
 +----+------------+----------+
 |  1 | John Smith | 3.700000 | 
 +----+------------+----------+
 1 row in set (0.00 sec)
 </pre><p>As you can see it works now.</p>
<h2><a class="anchor" id="manual_fmt_decimal_math">
Arithmetic operations</a></h2>
<p>PHP 5.2 does not nativly support operator overloading, until (or if) the feature ever becomes available you will have to use the following methods: </p>
<table class="doxtable">
<tr>
<th>Operator </th><th>Method  </th></tr>
<tr>
<td><code>=</code> </td><td><code>set()</code>   </td></tr>
<tr>
<td><code>+</code> </td><td><code>add()</code>   </td></tr>
<tr>
<td><code>-</code> </td><td><code>subtract()</code>   </td></tr>
<tr>
<td><code>*</code> </td><td><code>multiply()</code>   </td></tr>
<tr>
<td><code>/</code> </td><td><code>divide()</code>   </td></tr>
</table>
<p>The following code: </p>
<div class="fragment"><pre class="fragment"> $a = 5.2;
 $b = ($a + 2.3) / 1.3;
</pre></div><p>Using <a class="el" href="class_c_m_decimal.html" title="Handling exact values.">CMDecimal</a> would work like: </p>
<div class="fragment"><pre class="fragment"> $a = <span class="keyword">new</span> <a class="code" href="class_c_m_decimal.html" title="Handling exact values.">CMDecimal</a>(8, 1, 5.2);
 $b = $a-&gt;add(2.3)-&gt;divide(1.3);
</pre></div><h2><a class="anchor" id="manual_fmt_decimal_native">
Native integration</a></h2>
<p>Like all <code>CM</code> classes, <a class="el" href="class_c_m_decimal.html" title="Handling exact values.">CMDecimal</a> overrides the <code>__toString()</code> method so that a <a class="el" href="class_c_m_decimal.html" title="Handling exact values.">CMDecimal</a> object passed to any other function that doesn't understand/expect it can use it.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment"> $cost = <span class="keyword">new</span> <a class="code" href="class_c_m_decimal.html" title="Handling exact values.">CMDecimal</a>(8, 2, 15.35);
 $msg = <span class="stringliteral">&quot;The product costs \$$cost&quot;</span>;  <span class="comment">// The product costs $15.35</span>
</pre></div> </div>
<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
