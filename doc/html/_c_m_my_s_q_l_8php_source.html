<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMLIB: CMMySQL.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>CMMySQL.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 include_once(<span class="stringliteral">&quot;CMDatabaseProtocol.php&quot;</span>);
<a name="l00004"></a>00004 include_once(<span class="stringliteral">&quot;CMMySQLQuery.php&quot;</span>);
<a name="l00005"></a>00005 include_once(<span class="stringliteral">&quot;CMConstant.php&quot;</span>);
<a name="l00006"></a>00006 include_once(<span class="stringliteral">&quot;CMError.php&quot;</span>);
<a name="l00007"></a>00007 
<a name="l00489"></a><a class="code" href="class_c_m_my_s_q_l.html">00489</a> <span class="keyword">class </span><a class="code" href="class_c_m_my_s_q_l.html" title="MySQL connectivity class.">CMMySQL</a> <span class="keyword">extends</span> <a class="code" href="class_c_m_error.html" title="Error handling as a stand-alone or for classes vis inheritance.">CMError</a> implements <a class="code" href="interface_c_m_database_protocol.html" title="All database connectivity classes implement this interface.">CMDatabaseProtocol</a> {
<a name="l00490"></a>00490  
<a name="l00496"></a><a class="code" href="class_c_m_my_s_q_l.html#a9e2d53558e7b299d52b25c13d310d7e0">00496</a>  <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_c_m_my_s_q_l.html#a9e2d53558e7b299d52b25c13d310d7e0" title="The version of this class.">Version</a>() {
<a name="l00497"></a>00497   <span class="keywordflow">return</span> <span class="stringliteral">&quot;1.0&quot;</span>;
<a name="l00498"></a>00498  }
<a name="l00499"></a>00499  
<a name="l00505"></a><a class="code" href="class_c_m_my_s_q_l.html#ab51e04ce58ff27601a503f46d611b7e6">00505</a>  <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_c_m_my_s_q_l.html#ab51e04ce58ff27601a503f46d611b7e6" title="The version this class was introduced to the library.">Since</a>() {
<a name="l00506"></a>00506   <span class="keywordflow">return</span> <span class="stringliteral">&quot;1.0&quot;</span>;
<a name="l00507"></a>00507  }
<a name="l00508"></a>00508  
<a name="l00512"></a><a class="code" href="class_c_m_my_s_q_l.html#acc1e62674bb7200ea73767c19dc1344d">00512</a>  <span class="keyword">private</span> <a class="code" href="class_c_m_my_s_q_l.html#acc1e62674bb7200ea73767c19dc1344d" title="Internal database handle.">$dbh</a> = <span class="keyword">false</span>;
<a name="l00513"></a>00513  
<a name="l00519"></a><a class="code" href="class_c_m_my_s_q_l.html#a142c9a24d4f80b32faeb93ca6e77f5e3">00519</a>  <span class="keyword">private</span> <a class="code" href="class_c_m_my_s_q_l.html#a142c9a24d4f80b32faeb93ca6e77f5e3" title="The driver determines the PHP functions to call.">$driver</a> = <span class="stringliteral">&#39;mysqli&#39;</span>;
<a name="l00520"></a>00520  
<a name="l00527"></a><a class="code" href="class_c_m_my_s_q_l.html#a69423cb24968e09a427084bd5f1191d3">00527</a>  <span class="keyword">private</span> <a class="code" href="class_c_m_my_s_q_l.html#a69423cb24968e09a427084bd5f1191d3" title="Internal use.">$autoCommit</a> = <span class="keyword">true</span>;
<a name="l00528"></a>00528  
<a name="l00579"></a><a class="code" href="class_c_m_my_s_q_l.html#aea88b9053bc4fbad1bee6e82e3c6198e">00579</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#aea88b9053bc4fbad1bee6e82e3c6198e" title="Connect to a MySQL database.">CMMySQL</a>($uri, $a = <span class="keyword">false</span>) {
<a name="l00580"></a>00580   <span class="comment">// $a must be an array</span>
<a name="l00581"></a>00581   <span class="keywordflow">if</span>(!is_array($a))
<a name="l00582"></a>00582    $a = array($a =&gt; <span class="keyword">true</span>);
<a name="l00583"></a>00583    
<a name="l00584"></a>00584   <span class="comment">// set error stack</span>
<a name="l00585"></a>00585   <span class="keywordflow">if</span>(isset($a[<span class="stringliteral">&#39;error&#39;</span>]))
<a name="l00586"></a>00586    $this-&gt;<a class="code" href="class_c_m_error.html#a2c7cba178b8b7c609e99d9b308ead7f6" title="Redirect the errors to a different stack.">useErrorStack</a>($a[<span class="stringliteral">&#39;error&#39;</span>]);
<a name="l00587"></a>00587   
<a name="l00588"></a>00588   <span class="comment">// dissect the URI</span>
<a name="l00589"></a>00589   $v = parse_url($uri);
<a name="l00590"></a>00590   $v[<span class="stringliteral">&#39;db&#39;</span>] = basename($v[<span class="stringliteral">&#39;path&#39;</span>]);
<a name="l00591"></a>00591   <span class="keywordflow">if</span>(!isset($v[<span class="stringliteral">&#39;port&#39;</span>]))
<a name="l00592"></a>00592    $v[<span class="stringliteral">&#39;port&#39;</span>] = 3306;
<a name="l00593"></a>00593   
<a name="l00594"></a>00594   <span class="comment">// make sure the scheme is valid</span>
<a name="l00595"></a>00595   <span class="keywordflow">if</span>($v[<span class="stringliteral">&#39;scheme&#39;</span>] != <span class="stringliteral">&#39;mysql&#39;</span>) {
<a name="l00596"></a>00596    $this-&gt;<a class="code" href="class_c_m_error.html#a94a6cd26c794c35133502471eca8469e" title="Throw a Error level message.">throwError</a>(<span class="stringliteral">&quot;Unsupported driver &#39;{$v[&#39;scheme&#39;]}&#39;&quot;</span>);
<a name="l00597"></a>00597    <span class="keywordflow">return</span> $this;
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599   
<a name="l00600"></a>00600   <span class="comment">// attempt to connect</span>
<a name="l00601"></a>00601   <span class="keywordflow">if</span>(class_exists(<span class="stringliteral">&#39;mysqli&#39;</span>)) {
<a name="l00602"></a>00602    $this-&gt;driver = <span class="stringliteral">&#39;mysqli&#39;</span>;
<a name="l00603"></a>00603    
<a name="l00604"></a>00604    $this-&gt;dbh = @<span class="keyword">new</span> mysqli($v[<span class="stringliteral">&#39;host&#39;</span>], $v[<span class="stringliteral">&#39;user&#39;</span>], $v[<span class="stringliteral">&#39;pass&#39;</span>], $v[<span class="stringliteral">&#39;db&#39;</span>], $v[<span class="stringliteral">&#39;port&#39;</span>]);
<a name="l00605"></a>00605    <span class="keywordflow">if</span>($this-&gt;dbh-&gt;connect_error) {
<a name="l00606"></a>00606     $this-&gt;dbh = <span class="keyword">false</span>;
<a name="l00607"></a>00607     $this-&gt;<a class="code" href="class_c_m_error.html#a94a6cd26c794c35133502471eca8469e" title="Throw a Error level message.">throwError</a>(<span class="stringliteral">&quot;Unable to connect via MySQLi&quot;</span>,
<a name="l00608"></a>00608       array(<span class="stringliteral">&#39;number&#39;</span> =&gt; $this-&gt;dbh-&gt;connect_errno, <span class="stringliteral">&#39;message&#39;</span> =&gt; $this-&gt;dbh-&gt;connect_error));
<a name="l00609"></a>00609     <span class="keywordflow">return</span> $this;
<a name="l00610"></a>00610    }
<a name="l00611"></a>00611   } <span class="keywordflow">else</span> {
<a name="l00612"></a>00612    <span class="comment">// we have to use the old mysql driver</span>
<a name="l00613"></a>00613    $this-&gt;driver = <span class="stringliteral">&#39;mysql&#39;</span>;
<a name="l00614"></a>00614    
<a name="l00615"></a>00615    $this-&gt;dbh = mysql_connect($v[<span class="stringliteral">&#39;host&#39;</span>] . <span class="charliteral">&#39;:&#39;</span> . $v[<span class="stringliteral">&#39;port&#39;</span>], $v[<span class="stringliteral">&#39;user&#39;</span>], $v[<span class="stringliteral">&#39;pass&#39;</span>]);
<a name="l00616"></a>00616    <span class="keywordflow">if</span>(!$this-&gt;dbh) {
<a name="l00617"></a>00617     $this-&gt;dbh = <span class="keyword">false</span>;
<a name="l00618"></a>00618     $this-&gt;<a class="code" href="class_c_m_error.html#a94a6cd26c794c35133502471eca8469e" title="Throw a Error level message.">throwError</a>($this-&gt;dbh-&gt;connect_error,
<a name="l00619"></a>00619       array(<span class="stringliteral">&#39;number&#39;</span> =&gt; $this-&gt;dbh-&gt;connect_errno, <span class="stringliteral">&#39;message&#39;</span> =&gt; $this-&gt;dbh-&gt;connect_error));
<a name="l00620"></a>00620     <span class="keywordflow">return</span> $this;
<a name="l00621"></a>00621    }
<a name="l00622"></a>00622    
<a name="l00623"></a>00623    <span class="keywordflow">if</span>(!mysql_select_db($v[<span class="stringliteral">&#39;db&#39;</span>])) {
<a name="l00624"></a>00624     $this-&gt;<a class="code" href="class_c_m_error.html#a94a6cd26c794c35133502471eca8469e" title="Throw a Error level message.">throwError</a>($this-&gt;dbh-&gt;connect_error,
<a name="l00625"></a>00625       array(<span class="stringliteral">&#39;number&#39;</span> =&gt; $this-&gt;dbh-&gt;connect_errno, <span class="stringliteral">&#39;message&#39;</span> =&gt; $this-&gt;dbh-&gt;connect_error));
<a name="l00626"></a>00626     <span class="keywordflow">return</span> $this;
<a name="l00627"></a>00627    }
<a name="l00628"></a>00628   }
<a name="l00629"></a>00629  }
<a name="l00630"></a>00630  
<a name="l00657"></a><a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a">00657</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>($sql, $values = <span class="keyword">false</span>, $a = <span class="keyword">false</span>) {
<a name="l00658"></a>00658   <span class="comment">// $a must be an array</span>
<a name="l00659"></a>00659   <span class="keywordflow">if</span>(!is_array($a))
<a name="l00660"></a>00660    $a = array();
<a name="l00661"></a>00661   <span class="keywordflow">if</span>(!isset($a[<span class="stringliteral">&#39;execute&#39;</span>]))
<a name="l00662"></a>00662    $a[<span class="stringliteral">&#39;execute&#39;</span>] = <span class="keyword">true</span>;
<a name="l00663"></a>00663   
<a name="l00664"></a>00664   <span class="comment">// bind values</span>
<a name="l00665"></a>00665   $sql = $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a08895ad5ecec3e9850ebe052b020d928" title="Internal use for binding value in SQL statements.">bindValues</a>($sql, $values);
<a name="l00666"></a>00666   
<a name="l00667"></a>00667   <span class="keywordflow">if</span>(isset($a[<span class="stringliteral">&#39;print&#39;</span>]))
<a name="l00668"></a>00668    echo $sql;
<a name="l00669"></a>00669   
<a name="l00670"></a>00670   <span class="keywordflow">if</span>($a[<span class="stringliteral">&#39;execute&#39;</span>]) {
<a name="l00671"></a>00671    <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00672"></a>00672     $r = @$this-&gt;dbh-&gt;query($sql);
<a name="l00673"></a>00673    <span class="keywordflow">else</span> $r = mysql_query($sql, $this-&gt;dbh);
<a name="l00674"></a>00674   }
<a name="l00675"></a>00675    
<a name="l00676"></a>00676   <span class="keywordflow">if</span>(!$r) {
<a name="l00677"></a>00677    $this-&gt;<a class="code" href="class_c_m_error.html#a6d110c63a1c5103df7979612ed5209d3" title="Throw a Warning level message.">throwWarning</a>(<span class="stringliteral">&quot;Query failed&quot;</span>, array(<span class="stringliteral">&#39;sql&#39;</span> =&gt; $sql));
<a name="l00678"></a>00678    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_c_m_my_s_q_l_query.html" title="MySQL query handle.">CMMySQLQuery</a>($r, 0, $this-&gt;driver, $a);
<a name="l00679"></a>00679   }
<a name="l00680"></a>00680   
<a name="l00681"></a>00681   <span class="keywordflow">if</span>(isset($a[<span class="stringliteral">&#39;return&#39;</span>]))
<a name="l00682"></a>00682    <span class="keywordflow">return</span> $sql;
<a name="l00683"></a>00683   <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_c_m_my_s_q_l_query.html" title="MySQL query handle.">CMMySQLQuery</a>($r, $this-&gt;dbh-&gt;affected_rows, $this-&gt;driver, $a);
<a name="l00684"></a>00684  }
<a name="l00685"></a>00685  
<a name="l00696"></a><a class="code" href="class_c_m_my_s_q_l.html#a13148537025768f2373012227785c540">00696</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a13148537025768f2373012227785c540" title="Perform a query on the database that does not return a handle.">execute</a>($sql, $values = <span class="keyword">false</span>, $a = <span class="keyword">false</span>) {
<a name="l00697"></a>00697   $q = $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>($sql, $values, $a);
<a name="l00698"></a>00698   <span class="keywordflow">return</span> $q-&gt;success();
<a name="l00699"></a>00699  }
<a name="l00700"></a>00700  
<a name="l00722"></a><a class="code" href="class_c_m_my_s_q_l.html#a6502927265740994ba9898d919f17cdd">00722</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a6502927265740994ba9898d919f17cdd" title="MySQL INSERT.">insert</a>($tableName, $kv = <span class="keyword">false</span>, $a = <span class="keyword">false</span>) {
<a name="l00723"></a>00723   <span class="comment">// $a must be an array</span>
<a name="l00724"></a>00724   <span class="keywordflow">if</span>(!is_array($a))
<a name="l00725"></a>00725    $a = array();
<a name="l00726"></a>00726   
<a name="l00727"></a>00727   $sql = <span class="stringliteral">&quot;insert into `$tableName` (&quot;</span> . implode(<span class="charliteral">&#39;,&#39;</span>, array_keys($kv)) . <span class="stringliteral">&quot;) values (&quot;</span>;
<a name="l00728"></a>00728   $first = <span class="keyword">true</span>;
<a name="l00729"></a>00729   <span class="keywordflow">foreach</span>($kv as $k =&gt; $v) {
<a name="l00730"></a>00730    <span class="keywordflow">if</span>(!$first) $sql .= <span class="stringliteral">&quot;,&quot;</span>;
<a name="l00731"></a>00731    
<a name="l00732"></a>00732    <span class="comment">// if its a CMConstant we don&#39;t encapsulate it</span>
<a name="l00733"></a>00733    <span class="keywordflow">if</span>($v instanceof <a class="code" href="class_c_m_constant.html" title="A container for value that need not be modified or encapsulated.">CMConstant</a>)
<a name="l00734"></a>00734     $sql .= $v;
<a name="l00735"></a>00735    <span class="keywordflow">else</span> $sql .= <span class="stringliteral">&quot;&#39;&quot;</span> . mysql_real_escape_string($v) . <span class="stringliteral">&quot;&#39;&quot;</span>;
<a name="l00736"></a>00736    
<a name="l00737"></a>00737    $first = <span class="keyword">false</span>;
<a name="l00738"></a>00738   }
<a name="l00739"></a>00739   
<a name="l00740"></a>00740   <span class="keywordflow">if</span>(isset($a[<span class="stringliteral">&#39;print&#39;</span>]))
<a name="l00741"></a>00741    echo <span class="stringliteral">&quot;$sql)&quot;</span>;
<a name="l00742"></a>00742   
<a name="l00743"></a>00743   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>) {
<a name="l00744"></a>00744    $q = $this-&gt;dbh-&gt;prepare(<span class="stringliteral">&quot;$sql)&quot;</span>);
<a name="l00745"></a>00745    <span class="keywordflow">if</span>($q) {
<a name="l00746"></a>00746     $q-&gt;execute();
<a name="l00747"></a>00747     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>(<span class="stringliteral">&quot;select last_insert_id()&quot;</span>, <span class="keyword">false</span>, $a)-&gt;fetch(<span class="stringliteral">&#39;cell&#39;</span>);
<a name="l00748"></a>00748    }
<a name="l00749"></a>00749    $this-&gt;<a class="code" href="class_c_m_error.html#a6d110c63a1c5103df7979612ed5209d3" title="Throw a Warning level message.">throwWarning</a>(<span class="stringliteral">&quot;INSERT failed&quot;</span>, array(<span class="stringliteral">&#39;sql&#39;</span> =&gt; <span class="stringliteral">&quot;$sql)&quot;</span>));
<a name="l00750"></a>00750    <span class="keywordflow">return</span> 0;
<a name="l00751"></a>00751   }
<a name="l00752"></a>00752   
<a name="l00753"></a>00753   $q = mysql_query(<span class="stringliteral">&quot;$sql)&quot;</span>, $this-&gt;dbh);
<a name="l00754"></a>00754   <span class="keywordflow">if</span>($q)
<a name="l00755"></a>00755    <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>(<span class="stringliteral">&quot;select last_insert_id()&quot;</span>, <span class="keyword">false</span>, $a)-&gt;fetch(<span class="stringliteral">&#39;cell&#39;</span>);
<a name="l00756"></a>00756   
<a name="l00757"></a>00757   $this-&gt;<a class="code" href="class_c_m_error.html#a6d110c63a1c5103df7979612ed5209d3" title="Throw a Warning level message.">throwWarning</a>(<span class="stringliteral">&quot;INSERT failed&quot;</span>, array(<span class="stringliteral">&#39;sql&#39;</span> =&gt; <span class="stringliteral">&quot;$sql)&quot;</span>));
<a name="l00758"></a>00758   <span class="keywordflow">return</span> 0;
<a name="l00759"></a>00759  }
<a name="l00760"></a>00760  
<a name="l00774"></a><a class="code" href="class_c_m_my_s_q_l.html#a954293cf1be476b5009caa10ac71dfb2">00774</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a954293cf1be476b5009caa10ac71dfb2" title="Change the active database.">selectDatabase</a>($dbname, $a = <span class="keyword">false</span>) {
<a name="l00775"></a>00775   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00776"></a>00776    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;select_db($dbname);
<a name="l00777"></a>00777   <span class="keywordflow">return</span> mysql_select_db($dbname, $this-&gt;dbh);
<a name="l00778"></a>00778  }
<a name="l00779"></a>00779  
<a name="l00799"></a><a class="code" href="class_c_m_my_s_q_l.html#a08895ad5ecec3e9850ebe052b020d928">00799</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a08895ad5ecec3e9850ebe052b020d928" title="Internal use for binding value in SQL statements.">bindValues</a>($sql, $values = <span class="keyword">false</span>) {
<a name="l00800"></a>00800   <span class="keywordflow">if</span>(is_array($values)) {
<a name="l00801"></a>00801    $parts = explode(<span class="charliteral">&#39;?&#39;</span>, $sql);
<a name="l00802"></a>00802    $new_sql = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00803"></a>00803    <span class="keywordflow">for</span>($i = 0; $i &lt; count($parts) - 1; ++$i) {
<a name="l00804"></a>00804     <span class="comment">// if its a CMConstant we don&#39;t encapsulate it</span>
<a name="l00805"></a>00805     <span class="keywordflow">if</span>($values[$i] instanceof <a class="code" href="class_c_m_constant.html" title="A container for value that need not be modified or encapsulated.">CMConstant</a>)
<a name="l00806"></a>00806      $new_sql .= $parts[$i] . $values[$i];
<a name="l00807"></a>00807     <span class="keywordflow">else</span> {
<a name="l00808"></a>00808      <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00809"></a>00809       $new_sql .= $parts[$i] . <span class="stringliteral">&quot;&#39;&quot;</span> . $this-&gt;dbh-&gt;real_escape_string($values[$i]) . <span class="stringliteral">&quot;&#39;&quot;</span>;
<a name="l00810"></a>00810      <span class="keywordflow">else</span> $new_sql .= $parts[$i] . <span class="stringliteral">&quot;&#39;&quot;</span> . mysql_real_escape_string($values[$i]) . <span class="stringliteral">&quot;&#39;&quot;</span>;
<a name="l00811"></a>00811     }
<a name="l00812"></a>00812    }
<a name="l00813"></a>00813    $sql = $new_sql . $parts[count($parts) - 1];
<a name="l00814"></a>00814   } elseif($values !== <span class="keyword">false</span>) {
<a name="l00815"></a>00815    <span class="comment">// if its a CMConstant we don&#39;t encapsulate it</span>
<a name="l00816"></a>00816    <span class="keywordflow">if</span>($values[$i] instanceof <a class="code" href="class_c_m_constant.html" title="A container for value that need not be modified or encapsulated.">CMConstant</a>)
<a name="l00817"></a>00817     $sql = str_replace(<span class="charliteral">&#39;?&#39;</span>, $values, $sql);
<a name="l00818"></a>00818    <span class="keywordflow">else</span> {
<a name="l00819"></a>00819     <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00820"></a>00820      $sql = str_replace(<span class="charliteral">&#39;?&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span> . $this-&gt;dbh-&gt;real_escape_string($values) . <span class="stringliteral">&quot;&#39;&quot;</span>, $sql);
<a name="l00821"></a>00821     <span class="keywordflow">else</span> $sql = str_replace(<span class="charliteral">&#39;?&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span> . mysql_real_escape_string($values) . <span class="stringliteral">&quot;&#39;&quot;</span>, $sql);
<a name="l00822"></a>00822    }
<a name="l00823"></a>00823   }
<a name="l00824"></a>00824    
<a name="l00825"></a>00825   <span class="keywordflow">return</span> $sql;
<a name="l00826"></a>00826  }
<a name="l00827"></a>00827  
<a name="l00833"></a><a class="code" href="class_c_m_my_s_q_l.html#a36b890fb5812fc1247b8afe7d56e72ea">00833</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a36b890fb5812fc1247b8afe7d56e72ea" title="Fetch the list of tables in the active database.">getTableNames</a>($schema = <span class="keyword">false</span>) {
<a name="l00834"></a>00834   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>(<span class="stringliteral">&quot;show tables&quot;</span>)-&gt;fetchAll(<span class="stringliteral">&#39;cell&#39;</span>, <span class="stringliteral">&#39;vertical&#39;</span>);
<a name="l00835"></a>00835  }
<a name="l00836"></a>00836  
<a name="l00842"></a><a class="code" href="class_c_m_my_s_q_l.html#ae7cdaa744d52a1eb0103e377023ca528">00842</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#ae7cdaa744d52a1eb0103e377023ca528" title="Returns true or false for the selected database.">tableExists</a>($table) {
<a name="l00843"></a>00843   $q = $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>(<span class="stringliteral">&quot;show tables&quot;</span>);
<a name="l00844"></a>00844   <span class="keywordflow">while</span>($r = $q-&gt;fetch(<span class="stringliteral">&#39;line&#39;</span>)) {
<a name="l00845"></a>00845    <span class="keywordflow">if</span>($r[0] == $table)
<a name="l00846"></a>00846     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00847"></a>00847   }
<a name="l00848"></a>00848   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00849"></a>00849  }
<a name="l00850"></a>00850  
<a name="l00856"></a><a class="code" href="class_c_m_my_s_q_l.html#aea9c1153e0e0fc135f8d513263bf9201">00856</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#aea9c1153e0e0fc135f8d513263bf9201" title="Get database names.">getDatabaseNames</a>() {
<a name="l00857"></a>00857   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>(<span class="stringliteral">&quot;show databases&quot;</span>)-&gt;fetchAll(<span class="stringliteral">&#39;line&#39;</span>, <span class="stringliteral">&#39;vertical&#39;</span>);
<a name="l00858"></a>00858  }
<a name="l00859"></a>00859 
<a name="l00868"></a><a class="code" href="class_c_m_my_s_q_l.html#a7cf4f2839a152f2c11f5893c640c19dd">00868</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a7cf4f2839a152f2c11f5893c640c19dd" title="Get database names.">getSchemaNames</a>() {
<a name="l00869"></a>00869   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#aea9c1153e0e0fc135f8d513263bf9201" title="Get database names.">getDatabaseNames</a>();
<a name="l00870"></a>00870  }
<a name="l00871"></a>00871  
<a name="l00882"></a><a class="code" href="class_c_m_my_s_q_l.html#aa45cf2b82a91150a11cd11fa0bf2847c">00882</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#aa45cf2b82a91150a11cd11fa0bf2847c" title="Get available protocol methods.">availableMethods</a>() {
<a name="l00883"></a>00883   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00884"></a>00884    <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;query&#39;</span>, <span class="stringliteral">&#39;execute&#39;</span>, <span class="stringliteral">&#39;insert&#39;</span>, <span class="stringliteral">&#39;selectDatabase&#39;</span>,
<a name="l00885"></a>00885                 <span class="stringliteral">&#39;getTableNames&#39;</span>, <span class="stringliteral">&#39;tableExists&#39;</span>, <span class="stringliteral">&#39;getDatabaseNames&#39;</span>,
<a name="l00886"></a>00886                 <span class="stringliteral">&#39;getSchemaNames&#39;</span>, <span class="stringliteral">&#39;isConnected&#39;</span>, <span class="stringliteral">&#39;disconnect&#39;</span>,
<a name="l00887"></a>00887                 <span class="stringliteral">&#39;getClientVersion&#39;</span>, <span class="stringliteral">&#39;getServerVersion&#39;</span>, <span class="stringliteral">&#39;getClientInfo&#39;</span>,
<a name="l00888"></a>00888                 <span class="stringliteral">&#39;getHostInfo&#39;</span>, <span class="stringliteral">&#39;getServerInfo&#39;</span>, <span class="stringliteral">&#39;getProtocolVersion&#39;</span>,
<a name="l00889"></a>00889                 <span class="stringliteral">&#39;getLastInsertID&#39;</span>, <span class="stringliteral">&#39;setAutoCommit&#39;</span>, <span class="stringliteral">&#39;changeUser&#39;</span>,
<a name="l00890"></a>00890                 <span class="stringliteral">&#39;getCharacterSetName&#39;</span>, <span class="stringliteral">&#39;getCharacterSet&#39;</span>, <span class="stringliteral">&#39;commit&#39;</span>,
<a name="l00891"></a>00891                 <span class="stringliteral">&#39;getConnectionStatistics&#39;</span>, <span class="stringliteral">&#39;getWarnings&#39;</span>, <span class="stringliteral">&#39;killThread&#39;</span>,
<a name="l00892"></a>00892                 <span class="stringliteral">&#39;setOption&#39;</span>, <span class="stringliteral">&#39;ping&#39;</span>, <span class="stringliteral">&#39;escapeString&#39;</span>, <span class="stringliteral">&#39;rollback&#39;</span>,
<a name="l00893"></a>00893                 <span class="stringliteral">&#39;setCharacterSet&#39;</span>, <span class="stringliteral">&#39;setLocalInfileDefault&#39;</span>,
<a name="l00894"></a>00894                 <span class="stringliteral">&#39;setLocalInfileHandler&#39;</span>, <span class="stringliteral">&#39;SQLState&#39;</span>, <span class="stringliteral">&#39;getStatus&#39;</span>,
<a name="l00895"></a>00895                 <span class="stringliteral">&#39;getThreadID&#39;</span>, <span class="stringliteral">&#39;isThreadSafe&#39;</span>, <span class="stringliteral">&#39;getWarningCount&#39;</span>,
<a name="l00896"></a>00896                 <span class="stringliteral">&#39;engine&#39;</span>, <span class="stringliteral">&#39;eraseTable&#39;</span>, <span class="stringliteral">&#39;truncateTable&#39;</span>, <span class="stringliteral">&#39;update&#39;</span>,
<a name="l00897"></a>00897                 <span class="stringliteral">&#39;delete&#39;</span>, <span class="stringliteral">&#39;getAutoCommit&#39;</span>);
<a name="l00898"></a>00898    
<a name="l00899"></a>00899   <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;query&#39;</span>, <span class="stringliteral">&#39;execute&#39;</span>, <span class="stringliteral">&#39;insert&#39;</span>, <span class="stringliteral">&#39;selectDatabase&#39;</span>,
<a name="l00900"></a>00900                <span class="stringliteral">&#39;getTableNames&#39;</span>, <span class="stringliteral">&#39;tableExists&#39;</span>, <span class="stringliteral">&#39;getDatabaseNames&#39;</span>,
<a name="l00901"></a>00901                <span class="stringliteral">&#39;getSchemaNames&#39;</span>, <span class="stringliteral">&#39;isConnected&#39;</span>, <span class="stringliteral">&#39;disconnect&#39;</span>,
<a name="l00902"></a>00902                <span class="stringliteral">&#39;getLastInsertID&#39;</span>, <span class="stringliteral">&#39;ping&#39;</span>, <span class="stringliteral">&#39;escapeString&#39;</span>, <span class="stringliteral">&#39;engine&#39;</span>,
<a name="l00903"></a>00903                <span class="stringliteral">&#39;eraseTable&#39;</span>, <span class="stringliteral">&#39;truncateTable&#39;</span>, <span class="stringliteral">&#39;update&#39;</span>, <span class="stringliteral">&#39;delete&#39;</span>,
<a name="l00904"></a>00904                <span class="stringliteral">&#39;getAutoCommit&#39;</span>);
<a name="l00905"></a>00905  }
<a name="l00906"></a>00906  
<a name="l00912"></a><a class="code" href="class_c_m_my_s_q_l.html#af160f7fbbf281d018ae3162521b8267d">00912</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#af160f7fbbf281d018ae3162521b8267d" title="Check if the database handle is valid.">isConnected</a>() {
<a name="l00913"></a>00913   <span class="keywordflow">return</span> $this-&gt;dbh !== <span class="keyword">false</span>;
<a name="l00914"></a>00914  }
<a name="l00915"></a>00915  
<a name="l00919"></a><a class="code" href="class_c_m_my_s_q_l.html#abe175fcf658475bc56e9d6fa02bc88ec">00919</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#abe175fcf658475bc56e9d6fa02bc88ec" title="Disconnect database handle.">disconnect</a>() {
<a name="l00920"></a>00920   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00921"></a>00921    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;close();
<a name="l00922"></a>00922   <span class="keywordflow">return</span> mysql_close($this-&gt;dbh);
<a name="l00923"></a>00923  }
<a name="l00924"></a>00924  
<a name="l00937"></a><a class="code" href="class_c_m_my_s_q_l.html#acc8b801086cef69cbf92b77ee7434be0">00937</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#acc8b801086cef69cbf92b77ee7434be0" title="Get MySQL client info.">getClientVersion</a>() {
<a name="l00938"></a>00938   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00939"></a>00939    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;client_version;
<a name="l00940"></a>00940   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l00941"></a>00941  }
<a name="l00942"></a>00942  
<a name="l00955"></a><a class="code" href="class_c_m_my_s_q_l.html#a2d047b148eb053baba2150cc7d5d9545">00955</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a2d047b148eb053baba2150cc7d5d9545" title="Returns the version of the MySQL server as an integer.">getServerVersion</a>() {
<a name="l00956"></a>00956   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00957"></a>00957    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;server_version;
<a name="l00958"></a>00958   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l00959"></a>00959  }
<a name="l00960"></a>00960  
<a name="l00970"></a><a class="code" href="class_c_m_my_s_q_l.html#a20bb97bc69cce20f8ef039edb8e15c7b">00970</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a20bb97bc69cce20f8ef039edb8e15c7b" title="Returns the MySQL client version as a string.">getClientInfo</a>() {
<a name="l00971"></a>00971   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00972"></a>00972    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;client_info;
<a name="l00973"></a>00973   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l00974"></a>00974  }
<a name="l00975"></a>00975  
<a name="l00981"></a><a class="code" href="class_c_m_my_s_q_l.html#a822a163c8cecbe8f415a8c0f2857ce39">00981</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a822a163c8cecbe8f415a8c0f2857ce39" title="Host information.">getHostInfo</a>() {
<a name="l00982"></a>00982   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00983"></a>00983    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;host_info;
<a name="l00984"></a>00984   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l00985"></a>00985  }
<a name="l00986"></a>00986  
<a name="l00992"></a><a class="code" href="class_c_m_my_s_q_l.html#a9ea08ad9cca0630988d6c62d3f0ff672">00992</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a9ea08ad9cca0630988d6c62d3f0ff672" title="Client information.">getServerInfo</a>() {
<a name="l00993"></a>00993   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l00994"></a>00994    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;server_info;
<a name="l00995"></a>00995   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l00996"></a>00996  }
<a name="l00997"></a>00997  
<a name="l01003"></a><a class="code" href="class_c_m_my_s_q_l.html#a915c3328b367338a7c0eddb1e3294e9a">01003</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a915c3328b367338a7c0eddb1e3294e9a" title="Protocol version.">getProtocolVersion</a>() {
<a name="l01004"></a>01004   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01005"></a>01005    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;protocol_version;
<a name="l01006"></a>01006   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01007"></a>01007  }
<a name="l01008"></a>01008  
<a name="l01016"></a><a class="code" href="class_c_m_my_s_q_l.html#afd1c56cdadff97f9d86095f745e95658">01016</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#afd1c56cdadff97f9d86095f745e95658" title="Last insert ID.">getLastInsertID</a>() {
<a name="l01017"></a>01017   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01018"></a>01018    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;insert_id;
<a name="l01019"></a>01019   <span class="keywordflow">return</span> mysql_insert_id($this-&gt;dbh);
<a name="l01020"></a>01020  }
<a name="l01021"></a>01021  
<a name="l01035"></a><a class="code" href="class_c_m_my_s_q_l.html#af569120fcd4d04f33780d9c10daf144c">01035</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#af569120fcd4d04f33780d9c10daf144c" title="Turn on/off auto commit.">setAutoCommit</a>($mode = <span class="keyword">false</span>) {
<a name="l01036"></a>01036   $this-&gt;autoCommit = $mode;
<a name="l01037"></a>01037   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01038"></a>01038    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;autocommit($mode);
<a name="l01039"></a>01039   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01040"></a>01040  }
<a name="l01041"></a>01041  
<a name="l01051"></a><a class="code" href="class_c_m_my_s_q_l.html#ad4d20a51971e7855e1242afdbf58c6c6">01051</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#ad4d20a51971e7855e1242afdbf58c6c6" title="Change user.">changeUser</a>($user, $password, $database) {
<a name="l01052"></a>01052   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01053"></a>01053    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;change_user($user, $password, $database);
<a name="l01054"></a>01054   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01055"></a>01055  }
<a name="l01056"></a>01056  
<a name="l01062"></a><a class="code" href="class_c_m_my_s_q_l.html#a8e29393b9d21b47d9d8b931138001d3b">01062</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a8e29393b9d21b47d9d8b931138001d3b" title="Get the current character set.">getCharacterSetName</a>() {
<a name="l01063"></a>01063   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01064"></a>01064    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;character_set_name();
<a name="l01065"></a>01065   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01066"></a>01066  }
<a name="l01067"></a>01067  
<a name="l01073"></a><a class="code" href="class_c_m_my_s_q_l.html#adebb0782f7fc4b2b7feb34284e2f1d6f">01073</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#adebb0782f7fc4b2b7feb34284e2f1d6f" title="Returns a character set object.">getCharacterSet</a>() {
<a name="l01074"></a>01074   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01075"></a>01075    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;get_charset();
<a name="l01076"></a>01076   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01077"></a>01077  }
<a name="l01078"></a>01078  
<a name="l01094"></a><a class="code" href="class_c_m_my_s_q_l.html#af5674c27d4a92f6228565010eacbb9cb">01094</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#af5674c27d4a92f6228565010eacbb9cb" title="Commit transaction.">commit</a>() {
<a name="l01095"></a>01095   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01096"></a>01096    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;commit();
<a name="l01097"></a>01097   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01098"></a>01098  }
<a name="l01099"></a>01099  
<a name="l01230"></a><a class="code" href="class_c_m_my_s_q_l.html#af0b6151982de937b1321294efcc313d8">01230</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#af0b6151982de937b1321294efcc313d8" title="Get connection statistics.">getConnectionStatistics</a>() {
<a name="l01231"></a>01231   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01232"></a>01232    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;get_connection_stats();
<a name="l01233"></a>01233   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01234"></a>01234  }
<a name="l01235"></a>01235  
<a name="l01241"></a><a class="code" href="class_c_m_my_s_q_l.html#adc3b82cf30d1a6f68351b9bbcc88602e">01241</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#adc3b82cf30d1a6f68351b9bbcc88602e" title="Get result of SHOW WARNINGS.">getWarnings</a>() {
<a name="l01242"></a>01242   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01243"></a>01243    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;get_warnings();
<a name="l01244"></a>01244   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01245"></a>01245  }
<a name="l01246"></a>01246  
<a name="l01256"></a><a class="code" href="class_c_m_my_s_q_l.html#a101c0bf103093bc82ef1fa4b15d307e6">01256</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a101c0bf103093bc82ef1fa4b15d307e6" title="Kill a MySQL thread.">killThread</a>($threadID) {
<a name="l01257"></a>01257   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01258"></a>01258    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;kill($threadID);
<a name="l01259"></a>01259   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01260"></a>01260  }
<a name="l01261"></a>01261  
<a name="l01295"></a><a class="code" href="class_c_m_my_s_q_l.html#a1eb6a860a7e2236618f8d800b9fad69d">01295</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a1eb6a860a7e2236618f8d800b9fad69d" title="Set option.">setOption</a>($option, $value) {
<a name="l01296"></a>01296   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01297"></a>01297    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;options($option, $value);
<a name="l01298"></a>01298   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01299"></a>01299  }
<a name="l01300"></a>01300  
<a name="l01306"></a><a class="code" href="class_c_m_my_s_q_l.html#a6dad377f74b0ce6f21b485ba11052746">01306</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a6dad377f74b0ce6f21b485ba11052746" title="Ping this server connection.">ping</a>() {
<a name="l01307"></a>01307   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01308"></a>01308    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;ping();
<a name="l01309"></a>01309   <span class="keywordflow">return</span> mysql_ping($this-&gt;dbh);
<a name="l01310"></a>01310  }
<a name="l01311"></a>01311  
<a name="l01322"></a><a class="code" href="class_c_m_my_s_q_l.html#a2d931763c47d46ab7c26ba4e69d969d7">01322</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a2d931763c47d46ab7c26ba4e69d969d7" title="Escapes special characters in a string for use in a SQL statement.">escapeString</a>($str) {
<a name="l01323"></a>01323   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01324"></a>01324    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;real_escape_string($str);
<a name="l01325"></a>01325   <span class="keywordflow">return</span> mysql_real_escape_string($str);
<a name="l01326"></a>01326  }
<a name="l01327"></a>01327  
<a name="l01345"></a><a class="code" href="class_c_m_my_s_q_l.html#afa549adf79e3f8c09fe8f903dd5fbfa7">01345</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#afa549adf79e3f8c09fe8f903dd5fbfa7" title="Rolls back current transaction.">rollback</a>() {
<a name="l01346"></a>01346   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01347"></a>01347    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;rollback();
<a name="l01348"></a>01348   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01349"></a>01349  }
<a name="l01350"></a>01350  
<a name="l01367"></a><a class="code" href="class_c_m_my_s_q_l.html#ac2f8e8bdf8eda2090abeccdbd91320cd">01367</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#ac2f8e8bdf8eda2090abeccdbd91320cd" title="Sets the default client character set.">setCharacterSet</a>($charset) {
<a name="l01368"></a>01368   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01369"></a>01369    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;set_charset($charset);
<a name="l01370"></a>01370   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01371"></a>01371  }
<a name="l01372"></a>01372  
<a name="l01383"></a><a class="code" href="class_c_m_my_s_q_l.html#a55d9098fe5b6b646c9f05c5fbb6b758b">01383</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a55d9098fe5b6b646c9f05c5fbb6b758b" title="Unsets user defined handler for load local infile command.">setLocalInfileDefault</a>() {
<a name="l01384"></a>01384   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01385"></a>01385    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;set_local_infile_default();
<a name="l01386"></a>01386   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01387"></a>01387  }
<a name="l01388"></a>01388  
<a name="l01405"></a><a class="code" href="class_c_m_my_s_q_l.html#a6b86a59c6db416b221d1681a43af2b5f">01405</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a6b86a59c6db416b221d1681a43af2b5f" title="Set callback function for LOAD DATA LOCAL INFILE command.">setLocalInfileHandler</a>($readFunction) {
<a name="l01406"></a>01406   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01407"></a>01407    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;set_local_infile_handler($readFunction);
<a name="l01408"></a>01408   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01409"></a>01409  }
<a name="l01410"></a>01410  
<a name="l01427"></a><a class="code" href="class_c_m_my_s_q_l.html#af0b28816a2a9a4103bc791bed14ee1e0">01427</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#af0b28816a2a9a4103bc791bed14ee1e0" title="Returns the SQLSTATE error from previous MySQL operation.">SQLState</a>() {
<a name="l01428"></a>01428   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01429"></a>01429    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;sqlstate;
<a name="l01430"></a>01430   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01431"></a>01431  }
<a name="l01432"></a>01432  
<a name="l01444"></a><a class="code" href="class_c_m_my_s_q_l.html#a9d21636071f529e2154051d3ea6e5921">01444</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a9d21636071f529e2154051d3ea6e5921" title="Gets the current system status.">getStatus</a>() {
<a name="l01445"></a>01445   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01446"></a>01446    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;stat();
<a name="l01447"></a>01447   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01448"></a>01448  }
<a name="l01449"></a>01449  
<a name="l01466"></a><a class="code" href="class_c_m_my_s_q_l.html#a199f26152d3798a7539590aff3512d10">01466</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a199f26152d3798a7539590aff3512d10" title="Returns the thread ID for the current connection.">getThreadID</a>() {
<a name="l01467"></a>01467   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01468"></a>01468    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;thread_id();
<a name="l01469"></a>01469   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01470"></a>01470  }
<a name="l01471"></a>01471  
<a name="l01481"></a><a class="code" href="class_c_m_my_s_q_l.html#a25bbb4ed5bc8daac7fffedf74d9a3bde">01481</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a25bbb4ed5bc8daac7fffedf74d9a3bde" title="Returns whether thread safety is given or not.">isThreadSafe</a>() {
<a name="l01482"></a>01482   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01483"></a>01483    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;thread_safe();
<a name="l01484"></a>01484   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01485"></a>01485  }
<a name="l01486"></a>01486  
<a name="l01497"></a><a class="code" href="class_c_m_my_s_q_l.html#a955be18f8348a3e4f4802768bc5f5ed8">01497</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a955be18f8348a3e4f4802768bc5f5ed8" title="Returns the number of warnings from the last query for the given link.">getWarningCount</a>() {
<a name="l01498"></a>01498   <span class="keywordflow">if</span>($this-&gt;driver == <span class="stringliteral">&#39;mysqli&#39;</span>)
<a name="l01499"></a>01499    <span class="keywordflow">return</span> $this-&gt;dbh-&gt;warning_count;
<a name="l01500"></a>01500   <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_m_error.html#a23e9a4ce8ebfa6819c03be92539a0fd6" title="Throw an Unavailable level message.">throwUnavailable</a>(<span class="stringliteral">&quot;Only available with MySQLi&quot;</span>);
<a name="l01501"></a>01501  }
<a name="l01502"></a>01502  
<a name="l01508"></a><a class="code" href="class_c_m_my_s_q_l.html#a8147e0a0a8e607106004e2571195e01c">01508</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a8147e0a0a8e607106004e2571195e01c" title="Get the database product name.">engine</a>() {
<a name="l01509"></a>01509   <span class="keywordflow">return</span> <span class="stringliteral">&quot;MySQL&quot;</span>;
<a name="l01510"></a>01510  }
<a name="l01511"></a>01511  
<a name="l01515"></a><a class="code" href="class_c_m_my_s_q_l.html#a7516ca30af0db3cdbf9a7739b48ce91d">01515</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a7516ca30af0db3cdbf9a7739b48ce91d" title="Return the string value of this object.">__toString</a>() {
<a name="l01516"></a>01516   <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;&quot;</span> . get_class($this) . <span class="stringliteral">&quot;&gt;&quot;</span>;
<a name="l01517"></a>01517  }
<a name="l01518"></a>01518  
<a name="l01533"></a><a class="code" href="class_c_m_my_s_q_l.html#a7e4edd82127e0c6a2f42158fdbb258d3">01533</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a7e4edd82127e0c6a2f42158fdbb258d3" title="Erase (not truncate) a table.">eraseTable</a>($tableName) {
<a name="l01534"></a>01534   <span class="comment">// need a valid database handle</span>
<a name="l01535"></a>01535   <span class="keywordflow">if</span>($this-&gt;dbh === <span class="keyword">false</span>)
<a name="l01536"></a>01536    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01537"></a>01537   
<a name="l01538"></a>01538   $q = $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>(<span class="stringliteral">&quot;DELETE FROM `$tableName` WHERE 1&quot;</span>);
<a name="l01539"></a>01539   <span class="keywordflow">return</span> $q-&gt;success();
<a name="l01540"></a>01540  }
<a name="l01541"></a>01541  
<a name="l01556"></a><a class="code" href="class_c_m_my_s_q_l.html#aff013143f73f33653e2f60fecbde00cb">01556</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#aff013143f73f33653e2f60fecbde00cb" title="Truncate (not erase) a table.">truncateTable</a>($tableName) {
<a name="l01557"></a>01557   <span class="comment">// need a valid database handle</span>
<a name="l01558"></a>01558   <span class="keywordflow">if</span>($this-&gt;dbh === <span class="keyword">false</span>)
<a name="l01559"></a>01559    <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01560"></a>01560   
<a name="l01561"></a>01561   $q = $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>(<span class="stringliteral">&quot;TRUNCATE `$tableName`&quot;</span>);
<a name="l01562"></a>01562   <span class="keywordflow">return</span> $q-&gt;success();
<a name="l01563"></a>01563  }
<a name="l01564"></a>01564  
<a name="l01599"></a><a class="code" href="class_c_m_my_s_q_l.html#ac32a7f2a2c349c061f600bc0ac2fec86">01599</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#ac32a7f2a2c349c061f600bc0ac2fec86" title="MySQL UPDATE.">update</a>($tableName, $newvalues, $criteria = <span class="keyword">false</span>, $a = <span class="keyword">false</span>) {
<a name="l01600"></a>01600   <span class="comment">// $a must be an array</span>
<a name="l01601"></a>01601   <span class="keywordflow">if</span>(!is_array($a))
<a name="l01602"></a>01602    $a = array();
<a name="l01603"></a>01603   
<a name="l01604"></a>01604   $sql = <span class="stringliteral">&quot;UPDATE `$tableName` SET &quot;</span>;
<a name="l01605"></a>01605   $first = <span class="keyword">true</span>;
<a name="l01606"></a>01606   <span class="keywordflow">foreach</span>($newvalues as $k =&gt; $v) {
<a name="l01607"></a>01607    <span class="keywordflow">if</span>(!$first) $sql .= <span class="stringliteral">&quot;,&quot;</span>;
<a name="l01608"></a>01608    
<a name="l01609"></a>01609    <span class="comment">// if its a CMConstant we don&#39;t encapsulate it</span>
<a name="l01610"></a>01610    <span class="keywordflow">if</span>($v instanceof <a class="code" href="class_c_m_constant.html" title="A container for value that need not be modified or encapsulated.">CMConstant</a>)
<a name="l01611"></a>01611     $sql .= <span class="stringliteral">&quot;$k=$v&quot;</span>;
<a name="l01612"></a>01612    <span class="keywordflow">else</span> $sql .= <span class="stringliteral">&quot;$k=&#39;&quot;</span> . mysql_real_escape_string($v) . <span class="stringliteral">&quot;&#39;&quot;</span>;
<a name="l01613"></a>01613    
<a name="l01614"></a>01614    $first = <span class="keyword">false</span>;
<a name="l01615"></a>01615   }
<a name="l01616"></a>01616   
<a name="l01617"></a>01617   <span class="comment">// add WHERE clause</span>
<a name="l01618"></a>01618   <span class="keywordflow">if</span>($criteria !== <span class="keyword">false</span>) {
<a name="l01619"></a>01619    $sql .= <span class="stringliteral">&quot; WHERE &quot;</span>;
<a name="l01620"></a>01620    $first = <span class="keyword">true</span>;
<a name="l01621"></a>01621    <span class="keywordflow">foreach</span>($criteria as $k =&gt; $v) {
<a name="l01622"></a>01622     <span class="keywordflow">if</span>(!$first) $sql .= <span class="stringliteral">&quot; AND &quot;</span>;
<a name="l01623"></a>01623     
<a name="l01624"></a>01624     <span class="comment">// if its a CMConstant we don&#39;t encapsulate it</span>
<a name="l01625"></a>01625     <span class="keywordflow">if</span>($v instanceof <a class="code" href="class_c_m_constant.html" title="A container for value that need not be modified or encapsulated.">CMConstant</a>)
<a name="l01626"></a>01626      $sql .= <span class="stringliteral">&quot;$k=$v&quot;</span>;
<a name="l01627"></a>01627     <span class="keywordflow">else</span> $sql .= <span class="stringliteral">&quot;$k=&#39;&quot;</span> . mysql_real_escape_string($v) . <span class="stringliteral">&quot;&#39;&quot;</span>;
<a name="l01628"></a>01628     
<a name="l01629"></a>01629     $first = <span class="keyword">false</span>;
<a name="l01630"></a>01630    }
<a name="l01631"></a>01631   }
<a name="l01632"></a>01632   
<a name="l01633"></a>01633   <span class="keywordflow">if</span>(isset($a[<span class="stringliteral">&#39;print&#39;</span>]))
<a name="l01634"></a>01634    echo $sql;
<a name="l01635"></a>01635   
<a name="l01636"></a>01636   $q = $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>($sql, <span class="keyword">false</span>, $a);
<a name="l01637"></a>01637   <span class="keywordflow">if</span>($q-&gt;success())
<a name="l01638"></a>01638    <span class="keywordflow">return</span> $q-&gt;affectedRows();
<a name="l01639"></a>01639   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01640"></a>01640  }
<a name="l01641"></a>01641  
<a name="l01675"></a><a class="code" href="class_c_m_my_s_q_l.html#a2415ba06f043f104ed33b9571f200fc8">01675</a>  <span class="keyword">public</span> function <span class="keyword">delete</span>($tableName, $criteria = <span class="keyword">false</span>, $a = <span class="keyword">false</span>) {
<a name="l01676"></a>01676   <span class="comment">// $a must be an array</span>
<a name="l01677"></a>01677   <span class="keywordflow">if</span>(!is_array($a))
<a name="l01678"></a>01678    $a = array();
<a name="l01679"></a>01679   
<a name="l01680"></a>01680   $sql = <span class="stringliteral">&quot;DELETE FROM `$tableName`&quot;</span>;
<a name="l01681"></a>01681   
<a name="l01682"></a>01682   <span class="comment">// add WHERE clause</span>
<a name="l01683"></a>01683   <span class="keywordflow">if</span>($criteria !== <span class="keyword">false</span>) {
<a name="l01684"></a>01684    $sql .= <span class="stringliteral">&quot; WHERE &quot;</span>;
<a name="l01685"></a>01685    $first = <span class="keyword">true</span>;
<a name="l01686"></a>01686    <span class="keywordflow">foreach</span>($criteria as $k =&gt; $v) {
<a name="l01687"></a>01687     <span class="keywordflow">if</span>(!$first) $sql .= <span class="stringliteral">&quot; AND &quot;</span>;
<a name="l01688"></a>01688     
<a name="l01689"></a>01689     <span class="comment">// if its a CMConstant we don&#39;t encapsulate it</span>
<a name="l01690"></a>01690     <span class="keywordflow">if</span>($v instanceof <a class="code" href="class_c_m_constant.html" title="A container for value that need not be modified or encapsulated.">CMConstant</a>)
<a name="l01691"></a>01691      $sql .= <span class="stringliteral">&quot;$k=$v&quot;</span>;
<a name="l01692"></a>01692     <span class="keywordflow">else</span> $sql .= <span class="stringliteral">&quot;$k=&#39;&quot;</span> . mysql_real_escape_string($v) . <span class="stringliteral">&quot;&#39;&quot;</span>;
<a name="l01693"></a>01693     
<a name="l01694"></a>01694     $first = <span class="keyword">false</span>;
<a name="l01695"></a>01695    }
<a name="l01696"></a>01696   }
<a name="l01697"></a>01697   
<a name="l01698"></a>01698   <span class="keywordflow">if</span>(isset($a[<span class="stringliteral">&#39;print&#39;</span>]))
<a name="l01699"></a>01699    echo $sql;
<a name="l01700"></a>01700   
<a name="l01701"></a>01701   $q = $this-&gt;<a class="code" href="class_c_m_my_s_q_l.html#a4ced4e9cc5497c475c2cd1a03318f45a" title="Perform a query on the database that returns a handle to iterate the results.">query</a>($sql, <span class="keyword">false</span>, $a);
<a name="l01702"></a>01702   <span class="keywordflow">if</span>($q-&gt;success())
<a name="l01703"></a>01703    <span class="keywordflow">return</span> $q-&gt;affectedRows();
<a name="l01704"></a>01704   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01705"></a>01705  }
<a name="l01706"></a>01706  
<a name="l01713"></a><a class="code" href="class_c_m_my_s_q_l.html#a7327ec53765f61a4a9d715133d2ea2db">01713</a>  <span class="keyword">public</span> function <a class="code" href="class_c_m_my_s_q_l.html#a7327ec53765f61a4a9d715133d2ea2db" title="Return the auto commit status.">getAutoCommit</a>() {
<a name="l01714"></a>01714   <span class="keywordflow">return</span> $this-&gt;autoCommit;
<a name="l01715"></a>01715  }
<a name="l01716"></a>01716  
<a name="l01717"></a>01717 }
<a name="l01718"></a>01718 
<a name="l01719"></a>01719 ?&gt;
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
